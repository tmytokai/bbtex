bbtex - ブラックボード対応試験問題作成パッケージ

----------------------------
[開発環境]

Ubuntu Linux 12.04 (32bit)
e-pTeX 3.1415926-p3.3-110825-2.4 (utf8.euc) (TeX Live 2012/Debian)

----------------------------
[使い方]

パッケージファイル(bbtex.sty)をTexファイルと同じディレクトリに置き、プリアンブルに \usepackage{bbtex} と書く。

----------------------------
[ubuntu上でサンプル(sample.tex)をコンパイルしてブラックボードへアップロードするまでの手順]

1) bbtex.sty と sample.tex を同じディレクトリに置く

2) 

$ platex sample.tex
$ dvipdfmx sample.dvi

を実行して sample.pdf と bbtex.txt が出来ている事を確認

3) 

$ sed -e "s/_TAB_/\t/g" bbtex.txt > batch.txt

を実行して batch.txt が出来ていることを確認する

4) ブラックボードにログインして対象コースへ移動

5) コンテンツを開いて編集モードをオンにする

6) 「テスト/アンケート/課題」メニュー → 「テスト」項目 → 「新しいテストの作成」ボタンをクリック

7) 名前に「サンプルテスト」と入れて送信

8) 「質問のアップロード」メニューで上で作成した batch.txt を参照して送信する。
今回は「質問ごとの点数」を10のままにして送信(実際の問題をアップロードする時は点数を変えること)

9) 「質問の設定」メニュー → 「画像、ファイル、およびURLリンク」→「画像、ファイル、およびURLリンクを解答に追加する。」をチェックして送信

10) 「多肢選択問題: 1」の右側にある矢印にマウスカーソルを動かしてオプションを表示し「編集」を選ぶ

11) 編集画面が出たら「質問文」の「ファイルの挿入」アイコンをクリックし、sample.pdfを参照し、リンク名を付けて送信
新しいウィンドウで開くは「はい」を選択する

12) 送信

13) 画面の一番下までスクロールして「OK」を押す

14) テストの作成画面に戻ったら「既存のテストの追加」で「サンプルテスト」を指定して送信

15) テストオプションが表示されるので「テストの利用可否の設定」で「利用可能にする」を「はい」にする
その他のオプションはお好みで設定(実際のテストの時は表示開始日の指定を忘れないこと)

16) コンテンツに「サンプルテスト」が表示されるので動作確認する
問題1に問題文へのリンクがあるのでリンクの上でクリックして問題を表示する

17) 動作確認が終わったらログアウトし、 sample.tex の 

\makeanswersheet{3} % 解答用紙
と
\makeanswersheet[c]{3} % 模範解答
のコメントアウトを解除

18) 
$ platex sample.tex
$ dvipdfmx sample.dvi

を実行して sample.pdf を作り直すと解答用紙と模範解答が含まれている事を確認

19) \analysismode{10} のコメントアウトを外してから

$ platex sample.tex
$ dvipdfmx sample.dvi

を実行すると解析モードとして PDF が作られる(※ 解析モードの使い方は下の欄を参照)。


----------------------------
[解答項目分布解析用スクリプトを使って項目分析を行う手順]

# 解答項目分布解析用スクリプト

1) 解答項目分布解析用スクリプト(analysis.sh) と analysis.ods を用意する

2) ブラックボードの「成績管理」から試験結果の csv をダウンロードする(書式: カンマ、ユーザー別)

3) ダウンロードしたcsvを ファイル名-org.csv で保存する

4) ./analysis ファイル名 を実行して ファイル名.csv を出力する

5) analysis.ods と ファイル名.csv を開く

6) analysis.ods の説明に従って計算部を ファイル名.csv 上にコピー

7) 計算部の青色の部分を、試験問題文の tex ファイル(「解答項目分布の解析結果の読み込み」の所)にコピー

8) ブラックボードの解析画面を見て、その下にある 平均点、標準偏差、受験人数を更新

9) \analysismode のコメントを外してかっこの中に受験人数を指定してtexをコンパイル


----------------------------
[コマンド一覧]

-----------
機能：初期化 (命令)
書式：\initbb{乱数の種}{対象クラス}{試験名}{科目名}{日付}{教員}
説明：初期化を行う。解答項目のシャッフルを行う場合には乱数の種は省略不可かつ試験ごとに変更する必要がある。
使用例：\initbb{2015120801}{生産工学科1年}{前期中間試験}{テスト}{平成27年12月8日}{高専太郎}

-----------
機能：試験タイトル表示 (命令)
書式：\bbtitle
説明：試験タイトルを表示する。
使用例：\bbtitle

-----------
機能：大問見出し (命令)
書式：\bbsection{見出し}
説明：大問番号と見出しを表示する。
使用例：\bbsection{以下の問題を答えよ}

-----------
機能：問題作成 (環境)
書式：\begin{makeq}{得点}{ランダムシャッフル}{解答項目数}
説明：解答項目をランダムシャッフルする場合は2番目の引数を1、しないなら0を入れる。ランダムシャッフルしない場合は3番目の引数は無視する
使用例：\begin{makeq}{10}{0}{0}

-----------
機能：問題番号表示 (命令)
書式：\bbqnum
説明：現在の問題番号を表示する。
使用例：\bbqnum

-----------
機能：解答項目を表示しない (命令)
書式：\bbnoanswer
説明：解答項目を表示しない。makeq 環境の中で指定する。

-----------
機能：指定した解答項目の後で改行する (命令)
書式：\bbparanswer{問題用紙}{解析モード}{解答用紙}
説明：指定した解答項目の後で改行する。各用紙やモード別に指定出来る。改行しない場合は-1を指定する。makeq 環境の中で指定する。

-----------
機能：解答項目の重複をチェックしない (命令)
書式：\bbnodupcheck
説明：解答項目の重複をチェックしない。makeq 環境の中で指定する。

-----------
機能：正答の指定 (命令)
書式：\cor{値}
説明：makeq環境の中でincor命令とセットで使用する。正答が1つの場合は多肢選択、2つ以上の場合は複数回答問題となる。項目をランダムシャッフルしない場合はcorとincorの順と数に従って項目を作成する。ランダムシャッフルする場合はcorとincorの順番を無視する。
使用例：\cor{東京}

-----------
機能：誤答の指定 (命令)
書式：\incor{値}
説明：makeq環境の中でcor命令とセットで使用する。項目をランダムシャッフルする場合、incorは(makeqの引数で指定した項目数 - corの数)以上を指定できる。またcorとincorの順番は無視する。
使用例：\incor{ワシントン}

-----------
機能：正答にラベルを付ける (命令)
書式：\clabel[オプション]{ラベル名}{値}
オプション：
[l] ラベル名だけ表示(デフォルト), [f] ラベル名をfboxで囲む, [n] 何も表示しない
説明：makeq環境外で正答を指定する際にその値にラベルを付ける。cref命令と組み合わせて使用する。オプションでclabelのある場所に何を表示するか指定できる。
使用例：\clabel[f]{1}{\times}

-----------
機能：正答に問題番号のラベルを付ける (命令)
書式：\clabelqnum[オプション]{オフセット}{値}
説明：clabel命令のラベルとして「現在の問題番号 + オフセット」の値を指定する。それ以外はclabel命令と同じ動作をする。
使用例：現在の問題番号が 1 の時
\clabelqnum[f]{0}{\times} = \clabel[f]{1}{\times}
\clabelqnum[f]{1}{\times} = \clabel[f]{2}{\times}

-----------
機能：ラベルを付けた正答を指定 (命令)
書式：\cref{ラベル名}
説明：makeq環境内でclabel命令でラベルを付けた正答を指定する。それ以外はcor命令と同じ動作をする。
使用例：\cref{1}

-----------
機能：現在の問題番号のラベルを付けた正答を指定 (命令)
書式：\crefqnum
説明：cref命令のラベルとして「現在の問題番号 」の値を指定する。それ以外はcref命令と同じ動作をする
使用例：現在の問題番号が 1 の時
\crefqnum = \cref{1}

-----------
機能：合計得点表示 (命令)
書式：\totalscore
説明：合計得点を右詰めで表示する。
使用例：\totalscore

-----------
機能：解答用紙・模範解答作成 (命令)
書式：\makeanswersheet[オプション]{改頁する問題番号}
オプション：
[a] 解答用紙作成(デフォルト), [c] 模範解答作成
説明：オフライン用の解答用紙又は模範解答を作成する。改頁してから2段組で解答用紙を作成する。引数で指定した問題番号の後に更に改頁を入れる。
使用例：\makeanswersheet[c]{10}

-----------
機能：ブラックボードアップロード用バッチファイル作成 (命令)
書式：\makeanswerfile{ファイル名}
説明：ブラックボードで問題を作成する際にアップロードするバッチファイルを作成する。
注意：現在はタブコードの代わりに文字列 _TAB_ を出力しているので、 sed -e "s/_TAB_/\t/g" bbtex.txt > batch.txt の様に_TAB_をタブに置き換えてからアップロードする必要がある。
使用例：\makeanswerfile{bbtex.txt}

-----------
機能：解析モード (命令)
書式：\analysismode{受験人数}
説明：解析モードに変更する。

-----------
機能：解答項目を選択した人数 (命令)
書式：\distrib{解答番号}{解答項目番号}{人数}
説明：解析モードで使う。解答項目を選択した人数をセットする。
distrib.sh と dist-template.ods を使ってデータを作成する(詳しくはそれらの中の説明参照)
ランダムシャッフルモードでも指定順に表示する。

-----------
機能：解析モードでのコメント (命令)
書式：\analysiscomment{コメント1}{コメント2}
説明：解析モード時はコメント1を表示する。そうでない時はコメント2を表示する。
